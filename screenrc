# ============================================================================
# GNU Screen Configuration
# AI Coding Agent に最適化された設定
# ============================================================================

# ----------------------------------------------------------------------------
# 基本設定
# ----------------------------------------------------------------------------

# スタートアップメッセージを表示しない
startup_message off

# ビジュアルベルを使用
vbell on
vbell_msg " Bell! "

# バックグラウンドでも更新を受け取る
defmonitor on

# 自動デタッチを有効化
autodetach on

# ----------------------------------------------------------------------------
# スクロールバック設定
# ----------------------------------------------------------------------------

# スクロールバックバッファを10000行に設定（AI出力確認用に大きめ）
defscrollback 10000

# ----------------------------------------------------------------------------
# エンコーディングと表示設定
# ----------------------------------------------------------------------------

# UTF-8を使用
defutf8 on
defencoding utf8
encoding utf8 utf8

# 256色サポート
term xterm-256color
termcapinfo xterm* ti@:te@

# ----------------------------------------------------------------------------
# ステータスライン
# ----------------------------------------------------------------------------

# ハードステータスを表示
hardstatus alwayslastline
hardstatus string '%{= Kd} %{= Kd}%-w%{= Kr}[%{= KW}%n %t%{= Kr}]%{= Kd}%+w %-= %{KG} %H%{KW}|%{KY}%D %Y-%m-%d %{KW}%c:%s'

# キャプション（ウィンドウ名を表示）
caption always "%{= kw}%-w%{= BW}%n %t%{-}%+w %-= @%H"

# ----------------------------------------------------------------------------
# キーバインド
# ----------------------------------------------------------------------------

# Prefix キーを Ctrl-t に変更

# リージョン操作
# 縦分割: Ctrl-t |
bind | split -v

# 横分割: Ctrl-t S (デフォルト)
# bind S split

# リージョン間移動: Ctrl-t Tab
bind ^I focus

# リージョンを閉じる: Ctrl-t X
bind X remove

# 全リージョンを閉じる: Ctrl-t Q
bind Q only

# ----------------------------------------------------------------------------
# Vim風キーバインド（リージョン移動）
# ----------------------------------------------------------------------------

# hjkl でリージョン移動
bind h focus left
bind j focus down
bind k focus up
bind l focus right

# ウィンドウ移動
bind ^h prev
bind ^l next

# ----------------------------------------------------------------------------
# コピーモード設定
# ----------------------------------------------------------------------------

# コピーモードに入る: Ctrl-t [
# vi風キーバインド
markkeys "h=^B:l=^F:$=^E"

# ----------------------------------------------------------------------------
# ウィンドウ設定
# ----------------------------------------------------------------------------

# 新しいウィンドウはホームディレクトリから開始
chdir

# シェル設定
shell -$SHELL

# ----------------------------------------------------------------------------
# セッション管理
# ----------------------------------------------------------------------------

# ログ出力先
logfile "$HOME/.screen/screen-%Y%m%d-%n.log"

# 設定再読み込み: Ctrl-t F5
bind -k k5 source $HOME/.screenrc

# ----------------------------------------------------------------------------
# エスケープ文字設定
# ----------------------------------------------------------------------------

# Ctrl-t を2回押すと実際の Ctrl-t を送信
escape ^Tt

# ----------------------------------------------------------------------------
# 便利なキーバインド
# ----------------------------------------------------------------------------

# Ctrl-t r で設定再読み込み
bind r source $HOME/.screenrc

# Ctrl-t K でウィンドウを強制終了
bind K kill

# Ctrl-t _ でブランクウィンドウ（休憩用）
bind _ blank
